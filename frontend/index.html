<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.2/dist/pulse/bootstrap.min.css">
    <link rel="stylesheet" href="node_modules/bootstrap-icons/font/bootstrap-icons.css">
    <!-- SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
    <title>TTU Group Survey</title>
</head>

<body>

    <!-- Main container for SPA -->
    <!-- <div id="app"></div> -->

    <!-- Login form -->
    <div id="bgImage" class="bg-image d-flex align-items-center justify-content-center"  >
        <form class="card col-12 col-md-6 col-lg-4 rounded" id="frmLogin" >
            <div class="card-body">
                <h2 class="text-center">TTU Group Survey Login</h2>
                <h5 class="text-center">Login below</h5>

                <!-- Email -->
                <div class="mb-3">
                    <label for="strUsername" class="form-label d-flex align-items-start">Email</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-person-fill"></i></span>
                        <input id="strUsername" class="form-control" type="email" placeholder="JohnDoe@tntech.edu" aria-label="input for user Email">
                    </div>
                </div>
                
                <!-- Password -->
                <div class="mb-3">
                    <label for="strPassword" class="form-label">Password</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-lock-fill"></i></span>
                        <input id="strPassword" class="form-control" type="password" placeholder="Password" aria-label="Password">
                    </div>
                    <div class="text-right">
                        <button type="button" class="btn btn-link" id="btnForgot">Forgot Password</button>
                    </div>
                </div>

                <button type="button" class="btn btn-primary col-12 mt-2" id="btnLogin">Login</button>
                <button type="button" class="btn btn-link col-12 mt-0" id="btnSwap">Don't have an account? Register here</button>
            </div>
        </form>
        <form class="card col-12 col-md-6 col-lg-4 p-4 shadow" id="frmRegister" style="display:none;">
            <div class="card-body">
                <h2 class="text-center mb-3">TTU Group Survey Registration</h2>
                <h5 class="text-center mb-4">Register below</h5>
        
                <!-- First Name -->
                <div class="mb-3">
                    <label for="strFirstName" class="form-label">First Name</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-person-fill"></i></span>
                        <input id="strFirstName" class="form-control" type="text" placeholder="John" aria-label="First Name">
                    </div>
                </div>
        
                <!-- Middle Name -->
                <div class="mb-3">
                    <label for="strMiddleName" class="form-label">Middle Name</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-person-fill"></i></span>
                        <input id="strMiddleName" class="form-control" type="text" placeholder="Optional" aria-label="Middle Name">
                    </div>
                </div>
        
                <!-- Last Name -->
                <div class="mb-3">
                    <label for="strLastName" class="form-label">Last Name</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-person-fill"></i></span>
                        <input id="strLastName" class="form-control" type="text" placeholder="Doe" aria-label="Last Name">
                    </div>
                </div>
        
                <!-- Email -->
                <div class="mb-3">
                    <label for="strEmail" class="form-label">Email</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-envelope-fill"></i></span>
                        <input id="strEmail" class="form-control" type="email" placeholder="JohnDoe@tntech.edu" aria-label="Email">
                    </div>
                </div>
                
                <!-- Role -->
                <div class="mb-3">
                    <label for="strRole" class="form-label">Role</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-person-fill"></i></span>
                        <select id="strRole" class="form-select" aria-label="Input for role of user">
                            <option selected disabled value="">Select Role</option>
                            <option value="Student">Student</option>
                            <option value="Faculty">Faculty</option>
                        </select>
                    </div>
                </div>
        
                <!-- Password -->
                <div class="mb-3">
                    <label for="strNewPassword" class="form-label">Password</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-lock-fill"></i></span>
                        <input id="strNewPassword" class="form-control" type="password" placeholder="Password" aria-label="Password">
                    </div>
                </div>
        
                <!-- Confirm Password -->
                <div class="mb-3">
                    <label for="strConfirmPassword" class="form-label">Confirm Password</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-lock-fill"></i></span>
                        <input id="strConfirmPassword" class="form-control" type="password" placeholder="Confirm Password" aria-label="Confirm Password">
                    </div>
                </div>
        
                <!-- Register Button -->
                <button type="button" class="btn btn-primary col-12 mt-3" id="btnRegister">Register</button>
        
                <!-- Back to Login Button -->
                <button type="button" class="btn btn-link col-12 mt-2 text-center" id="btnBack">Already have an account? Login here</button>
            </div>
        </form>
    </div>

    <!-- Student Dashboard (Outside of background image container) -->
    <div>
        <form  id="frmStudentDash" style="display:none; background: linear-gradient(360deg, rgb(127, 114, 153) 25%, rgba(127, 114, 153, 0) 50%); min-height: 100vh; overflow: auto;">
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark w-100">
                <div class="container">
                    <a class="navbar-brand" href="#">TTU Group Survey</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                            <li class="nav-item">
                                <a class="nav-link active" aria-current="page" href="#">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">Surveys</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    Account
                                </a>
                                <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                    <li><a class="dropdown-item" href="#">Profile</a></li>
                                    <li><a class="dropdown-item" href="#">Settings</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item" href="#" id="btnLogout" onclick="logout()">Logout</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <div class="container mt-4 " >
                <h1>Student Dashboard</h1>
                <p>Welcome to your student dashboard. Here you can view and complete surveys.</p>
                
                <div class="row mt-4">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Available Surveys</h5>
                                <p class="card-text">You have 3 surveys waiting for your response.</p>
                                <button class="btn btn-primary" id="btnViewAvaSurveys">View Surveys</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Completed Surveys</h5>
                                <p class="card-text">You have completed 5 surveys.</p>
                                <a href="#" class="btn btn-secondary">View History</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Groups</h5>
                                <p class="card-text">You are a member of 2 groups.</p>
                                <a href="#" class="btn btn-info">View Groups</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- View Surveys Modal -->
            <div class="modal fade" id="viewSurveysModal" tabindex="-1" aria-labelledby="viewSurveysModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="viewSurveysModalLabel">Available Surveys</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div id="surveysList" class="list-group">
                                <!-- Surveys will be loaded here dynamically -->
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Survey Detail Modal -->
            <div class="modal fade" id="surveyDetailModal" tabindex="-1" aria-labelledby="surveyDetailModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="surveyDetailModalLabel">Survey Details</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div id="surveyDetailContent">
                                <!-- Survey details will be loaded here dynamically -->
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" id="btnEditSurvey">Edit</button>
                            <button type="button" class="btn btn-danger" id="btnDeleteSurvey">Delete</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Group Responses Modal -->
            <div class="modal fade" id="groupResponsesModal" tabindex="-1" aria-labelledby="groupResponsesModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="groupResponsesModalLabel">Group Responses</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div id="groupResponsesContent">
                                <!-- Group responses will be loaded here dynamically -->
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Manage Groups Modal -->
            <div class="modal fade" id="manageGroupsModal" tabindex="-1" aria-labelledby="manageGroupsModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="manageGroupsModalLabel">Manage Groups</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="d-flex justify-content-end mb-3">
                                <button type="button" class="btn btn-success" id="btnAddNewGroup">
                                    <i class="bi bi-plus-circle"></i> Add New Group
                                </button>
                            </div>
                            <div id="groupsListContainer" class="list-group">
                                <!-- Groups will be loaded here dynamically -->
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Add custom CSS for modal z-index -->
            <style>
                .modal-backdrop {
                    z-index: 1050;
                }
                #createSurveyModal {
                    z-index: 1055 !important;
                }
                #createSurveyModal .modal-dialog {
                    z-index: 1056 !important;
                }
                #addFieldModal {
                    z-index: 1060 !important;
                }
                #addFieldModal .modal-dialog {
                    z-index: 1061 !important;
                }
                #addGroupModal {
                    z-index: 1060 !important;
                }
                #addGroupModal .modal-dialog {
                    z-index: 1061 !important;
                }
                #manageGroupsModal {
                    z-index: 1060 !important;
                }
                #manageGroupsModal .modal-dialog {
                    z-index: 1061 !important;
                }
                .blur-background {
                    filter: blur(5px);
                    -webkit-filter: blur(5px);
                }
            </style>
        </form>
    </div>
    <!-- Faculty Dashbord -->
    <div>
        <form id="frmFacultyDash" style="display:none;">
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">  
                <div class="container-fluid">
                    <a class="navbar-brand" href="#">TTU Group Survey</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                            <li class="nav-item">
                                <a class="nav-link active" aria-current="page" href="#">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#" id="btnCreateSurvey">Create Survey</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">Manage Groups</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    Account
                                </a>
                                <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                    <li><a class="dropdown-item" href="#">Profile</a></li>
                                    <li><a class="dropdown-item" href="#">Settings</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item" href="#" id="btnLogout" onclick="logout()">Logout</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <div class="container mt-4">
                <h1>Faculty Dashboard</h1>
                <p>Welcome to your faculty dashboard. Here you can create and manage surveys.</p>
                
                <div class="row mt-4">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Create Survey</h5>
                                <p class="card-text">Create a new survey for your students.</p>
                                <button class="btn btn-primary" id="btnCreateSurveyCard">Create Survey</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Active Surveys</h5>
                                <p class="card-text">You have <span id="activeSurveyCount">0</span> active surveys.</p>
                                <button class="btn btn-secondary" id="btnViewActSurveys">View Surveys</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Manage Groups</h5>
                                <p class="card-text">Create and manage student groups.</p>
                                <a href="#" class="btn btn-info">Manage Groups</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Create Survey Modal -->
            <div class="modal fade" id="createSurveyModal" tabindex="-1" aria-labelledby="createSurveyModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="createSurveyModalLabel">Create New Survey</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form id="surveyForm">
                                <div class="mb-3">
                                    <label for="surveyTitle" class="form-label">Survey Title</label>
                                    <input type="text" class="form-control" id="surveyTitle" required>
                                </div>
                                <div class="mb-3">
                                    <label for="surveyDescription" class="form-label">Survey Description</label>
                                    <textarea class="form-control" id="surveyDescription" rows="3"></textarea>
                                </div>
                                
                                <div class="mb-3">
                                    <h5>Survey Fields</h5>
                                    <div id="surveyFields" class="mb-3">
                                        <!-- Fields will be added here dynamically -->
                                    </div>
                                    <button type="button" class="btn btn-success" id="btnAddField">
                                        <i class="bi bi-plus-circle"></i> Add Field
                                    </button>
                                </div>
                                
                                <div class="mb-3">
                                    <h5>Assign to Groups</h5>
                                    <div id="groupsList" class="mb-3">
                                        <!-- Groups will be added here dynamically -->
                                    </div>
                                    <button type="button" class="btn btn-success" id="btnAddGroup">
                                        <i class="bi bi-plus-circle"></i> Add Group
                                    </button>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" id="btnSaveSurvey">Save Survey</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Add Field Modal -->
            <div class="modal fade" id="addFieldModal" tabindex="-1" aria-labelledby="addFieldModalLabel" aria-hidden="true" style="z-index: 1060;">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="addFieldModalLabel">Add Survey Field</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form id="fieldForm">
                                <div class="mb-3">
                                    <label for="fieldLabel" class="form-label">Field Label</label>
                                    <input type="text" class="form-control" id="fieldLabel" required>
                                </div>
                                <div class="mb-3">
                                    <label for="fieldType" class="form-label">Field Type</label>
                                    <select class="form-select" id="fieldType" required>
                                        <option value="text">Text Box</option>
                                        <option value="textarea">Text Area</option>
                                        <option value="select">Dropdown</option>
                                        <option value="multiselect">Multiple Select</option>
                                        <option value="radio">Radio Buttons</option>
                                        <option value="checkbox">Checkboxes</option>
                                        <option value="date">Date</option>
                                        <option value="number">Number</option>
                                    </select>
                                </div>
                                <div class="mb-3" id="optionsContainer" style="display: none;">
                                    <label for="fieldOptions" class="form-label">Options (one per line)</label>
                                    <textarea class="form-control" id="fieldOptions" rows="3"></textarea>
                                </div>
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="fieldRequired">
                                    <label class="form-check-label" for="fieldRequired">
                                        Required field
                                    </label>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" id="btnSaveField">Add Field</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Add Group Modal -->
            <div class="modal fade" id="addGroupModal" tabindex="-1" aria-labelledby="addGroupModalLabel" aria-hidden="true" style="z-index: 1060;">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="addGroupModalLabel">Add Group</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form id="groupForm">
                                <div class="mb-3">
                                    <label for="groupName" class="form-label">Group Name</label>
                                    <input type="text" class="form-control" id="groupName" required>
                                </div>
                                <div class="mb-3">
                                    <label for="groupMembers" class="form-label">Group Members (one per line)</label>
                                    <textarea class="form-control" id="groupMembers" rows="5" required></textarea>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" id="btnSaveGroup">Add Group</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- View Surveys Modal -->
            <div class="modal fade" id="viewSurveysModal" tabindex="-1" aria-labelledby="viewSurveysModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="viewSurveysModalLabel">Your Surveys</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div id="surveysList" class="list-group">
                                <!-- Surveys will be loaded here dynamically -->
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Survey Detail Modal -->
            <div class="modal fade" id="surveyDetailModal" tabindex="-1" aria-labelledby="surveyDetailModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="surveyDetailModalLabel">Survey Details</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div id="surveyDetailContent">
                                <!-- Survey details will be loaded here dynamically -->
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" id="btnEditSurvey">Edit</button>
                            <button type="button" class="btn btn-danger" id="btnDeleteSurvey">Delete</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Group Responses Modal -->
            <div class="modal fade" id="groupResponsesModal" tabindex="-1" aria-labelledby="groupResponsesModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="groupResponsesModalLabel">Group Responses</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div id="groupResponsesContent">
                                <!-- Group responses will be loaded here dynamically -->
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Manage Groups Modal -->
            <div class="modal fade" id="manageGroupsModal" tabindex="-1" aria-labelledby="manageGroupsModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="manageGroupsModalLabel">Manage Groups</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="d-flex justify-content-end mb-3">
                                <button type="button" class="btn btn-success" id="btnAddNewGroup">
                                    <i class="bi bi-plus-circle"></i> Add New Group
                                </button>
                            </div>
                            <div id="groupsListContainer" class="list-group">
                                <!-- Groups will be loaded here dynamically -->
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Add custom CSS for modal z-index -->
            <style>
                .modal-backdrop {
                    z-index: 1050;
                }
                #createSurveyModal {
                    z-index: 1055 !important;
                }
                #createSurveyModal .modal-dialog {
                    z-index: 1056 !important;
                }
                #addFieldModal {
                    z-index: 1060 !important;
                }
                #addFieldModal .modal-dialog {
                    z-index: 1061 !important;
                }
                #addGroupModal {
                    z-index: 1060 !important;
                }
                #addGroupModal .modal-dialog {
                    z-index: 1061 !important;
                }
                #manageGroupsModal {
                    z-index: 1060 !important;
                }
                #manageGroupsModal .modal-dialog {
                    z-index: 1061 !important;
                }
                .blur-background {
                    filter: blur(5px);
                    -webkit-filter: blur(5px);
                }
            </style>
        </form>
    </div>
    

    
   
</body>
 <!-- Bootstrap JS -->
 <script type="module" src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    
 <!-- SweetAlert2 JS -->
 <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
 
 <!-- Main application script -->
 <script>
    // Wait for DOM to be fully loaded
    document.addEventListener('DOMContentLoaded', function() {
        // Validation for Login Form
        const btnLogin = document.querySelector("#btnLogin");
        if (btnLogin) {
            btnLogin.addEventListener("click", handleLogin);
        }

        // Validation for Registration Form
        const btnRegister = document.querySelector("#btnRegister");
        if (btnRegister) {
            btnRegister.addEventListener("click", handleRegister);
        }

        // Form switching
        const btnSwap = document.getElementById('btnSwap');
        if (btnSwap) {
            btnSwap.addEventListener('click', function(){
                document.getElementById('frmLogin').style.display = 'none';
                document.getElementById('frmRegister').style.display = 'block';
            });
        }

        const btnBack = document.getElementById('btnBack');
        if (btnBack) {
            btnBack.addEventListener('click', function(){
                document.getElementById('frmLogin').style.display='block';
                document.getElementById('frmRegister').style.display='none';
            });
        }

        // Forgot Password
        const btnForgot = document.getElementById('btnForgot');
        if (btnForgot) {
            btnForgot.addEventListener('click', function(){
                Swal.fire({
                    title: 'Forgot Password',
                    text: 'Please contact Professor for password reset',
                    icon: 'info',
                    confirmButtonText: 'OK'
                });
            });
        }

        // View Available Surveys Modal
        const btnViewAvaSurveys = document.getElementById('btnViewAvaSurveys');
        if (btnViewAvaSurveys) {
            btnViewAvaSurveys.addEventListener('click', function() {
                const modal = document.getElementById('viewSurveysModal');
                if (modal) {
                    var myModal = new bootstrap.Modal(modal);
                    myModal.show();
                }
            });
        }

        // View Active Surveys Modal
        const btnViewActSurveys = document.getElementById('btnViewActSurveys');
        if (btnViewActSurveys) {
            btnViewActSurveys.addEventListener('click', function() {
                const modal = document.getElementById('viewSurveysModal');
                if (modal) {
                    var myModal = new bootstrap.Modal(modal);
                    myModal.show();
                }
            });
        }

        // Create Survey Modal
        const btnCreateSurvey = document.getElementById('btnCreateSurvey');
        if (btnCreateSurvey) {
            btnCreateSurvey.addEventListener('click', function() {
                const modal = document.getElementById('createSurveyModal');
                if (modal) {
                    var myModal = new bootstrap.Modal(modal);
                    myModal.show();
                }
            });
        }

        // Logout button
        const btnLogout = document.getElementById('btnLogout');
        if (btnLogout) {
            btnLogout.addEventListener('click', logout);
        }
    });

    // Login handler
    function handleLogin(e) {
        e.preventDefault();
        
        const strEmail = document.querySelector("#strUsername").value.trim();
        const strPassword = document.querySelector("#strPassword").value.trim();
        console.log("Captured Password:", strPassword);

        const regEmail = /^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/i;
        const regPassword = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/;
        let blnError = false;
        let strMessage = "";

        if (!regEmail.test(strEmail)) {
            blnError = true;
            strMessage += "<p>Please enter a valid email address.</p>";
        } 
        if (!regPassword.test(strPassword)) {
            blnError = true;
            strMessage += "<p>Please enter a valid password.</p>";
        }

        if (blnError) {
            Swal.fire({
                title: "Error",
                html: strMessage,
                icon: "error",
            });
        } else {
            // For demo purposes, create a mock user based on email
            const role = strEmail.includes('student') ? 'Student' : 'Faculty';
            const userData = {
                email: strEmail,
                password: strPassword,
                role: role,
                firstName: 'John',
                lastName: 'Doe',
                middleName: '',
                createdAt: new Date().toISOString()
            };
            
            try {
                localStorage.setItem('currentUser', JSON.stringify(userData));
                
                Swal.fire({
                    title: "Success!",
                    text: `Login successful! Redirecting to ${role.toLowerCase()} dashboard...`,
                    icon: "success",
                    timer: 1500,
                    showConfirmButton: false
                }).then(() => {
                    const bgImage = document.getElementById("bgImage");
                    if (bgImage) bgImage.style.display = "none";
                    
                    if (role === 'Student') {
                        const studentDash = document.getElementById("frmStudentDash");
                        if (studentDash) studentDash.style.display = "block";
                    } else {
                        const facultyDash = document.getElementById("frmFacultyDash");
                        if (facultyDash) facultyDash.style.display = "block";
                    }
                });
            } catch (error) {
                console.error("Error saving user data:", error);
                Swal.fire({
                    title: "Error",
                    text: "Failed to save user data. Please try again.",
                    icon: "error"
                });
            }
        }
    }

    // Registration handler
    function handleRegister(e) {
        e.preventDefault();
        
        const regEmail = /^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/i;
        const regPass = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/;
        const role = document.getElementById("strRole").value;

        let email = document.querySelector("#strEmail").value.trim();
        let password = document.querySelector("#strNewPassword").value.trim();
        let confirmPassword = document.querySelector("#strConfirmPassword").value.trim();
        let firstName = document.querySelector("#strFirstName").value.trim();
        let lastName = document.querySelector("#strLastName").value.trim();
        let middleName = document.querySelector("#strMiddleName").value.trim();
        
        let errors = "";

        // Required Field Validation
        if (!firstName) errors += "<p class='mb-1 mt-1'>First Name is required</p>";
        if (!lastName) errors += "<p class='mb-1 mt-1'>Last Name is required</p>";    

        // Email Validation
        if (!regEmail.test(email)) {
            errors += "<p class='mb-1 mt-1'>Invalid email format</p>";
        }

        // Password Validation
        if (!regPass.test(password)) {
            errors += "<p class='mb-1 mt-1'>Password must be at least 8 characters, contain one uppercase letter, one lowercase letter, and one number</p>";
        }

        if (password !== confirmPassword) {
            errors += "<p class='mb-1 mt-1'>Passwords do not match</p>";
        }

        if (errors) {
            Swal.fire({
                title: "Registration Error!",
                html: errors,
                icon: "error"
            });
        } else {
            try {
                // Store user data in localStorage
                const userData = {
                    firstName,
                    middleName,
                    lastName,
                    email,
                    password,
                    role,
                    createdAt: new Date().toISOString()
                };
                
                localStorage.setItem('currentUser', JSON.stringify(userData));
                
                if(role === 'Student'){
                    Swal.fire({
                        icon: "success",
                        title: "Registration Successful",
                        text: "Sending student to the student dashboard"
                    }).then(()=>{
                        const studentDash = document.getElementById("frmStudentDash");
                        const registerForm = document.getElementById("frmRegister");
                        const bgImage = document.getElementById("bgImage");
                        
                        if (studentDash) studentDash.style.display = "block";
                        if (registerForm) registerForm.style.display = "none";
                        if (bgImage) bgImage.style.display = "none";
                    });
                } else if(role === 'Faculty'){
                    Swal.fire({
                        icon: "success",
                        title: "Registration Successful",
                        text: "Sending faculty to the faculty dashboard"
                    }).then(()=>{
                        const facultyDash = document.getElementById("frmFacultyDash");
                        const registerForm = document.getElementById("frmRegister");
                        const bgImage = document.getElementById("bgImage");
                        
                        if (facultyDash) facultyDash.style.display = "block";
                        if (registerForm) registerForm.style.display = "none";
                        if (bgImage) bgImage.style.display = "none";
                    });
                } else {
                    Swal.fire({
                        icon: "error",
                        title: "Registration Error",
                        text: "Please select a valid role"
                    });
                }
            } catch (error) {
                console.error("Error saving user data:", error);
                Swal.fire({
                    title: "Error",
                    text: "Failed to save user data. Please try again.",
                    icon: "error"
                });
            }
        }
    }

    // Logout function
    function logout() {
        Swal.fire({
            title: 'Are you sure you want to logout?',
            text: "You will now be redirected to login page",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Yes, Logout Please!',
            cancelButtonText: "No, Don't leave",
        }).then((result)=> {
            if (result.isConfirmed){
                try {
                    localStorage.removeItem('currentUser');
                    
                    const studentDash = document.getElementById("frmStudentDash");
                    const loginForm = document.getElementById("frmLogin");
                    const facultyDash = document.getElementById("frmFacultyDash");
                    const bgImage = document.getElementById("bgImage");
                    
                    if (studentDash) studentDash.style.display = "none";
                    if (loginForm) loginForm.style.display = "block";
                    if (facultyDash) facultyDash.style.display = "none";
                    if (bgImage) bgImage.style.display = "block";
                } catch (error) {
                    console.error("Error during logout:", error);
                    Swal.fire({
                        title: "Error",
                        text: "Failed to logout. Please try again.",
                        icon: "error"
                    });
                }
            } else {
                Swal.fire({
                    title: 'Logout Cancelled',
                    text: 'You are still logged in',
                    icon: 'error',
                    confirmButtonText: 'OK'
                });
            }
        });
    }
</script>
</html>